<!DOCTYPE html>
<html>

<body>

<p>Password: </p><input id="password" type="password" />
<button id="login">Login</button>
<p id="output"></p>

<script src="js/openpgp.min.js"></script>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/readFile.js"></script>
<script src="js/decrypt.js"></script>
<script type="text/javascript">

(async function() {

	document.getElementById("login").addEventListener("click", async function()
	{
		var output = document.getElementById("output");

		if(document.getElementById("password").value == "")
		{
			output.innerHTML = "No password provided";
			output.style.color = "red";
		}
		else
		{
			var encrypted = await readFile("data/test.asc");		
			console.log("encrypted file: " + encrypted);
			await decrypt(encrypted);
		}
			
	});



	/*var options, encrypted;

	// Read encrypted file
	await $.get("data/test.asc", function(response)
	{
		encrypted = response;
		console.log("read encrypted file: " + encrypted);
	});


	//Decrypt
	options = {
		message: await openpgp.message.readArmored(encrypted), // parse encrypted bytes
		passwords: ['testpassword'],              		// decrypt with password
		format: 'utf8'                          		// output as Uint8Array
	};

	openpgp.decrypt(options).then(function(plainText) {
		console.log("contenu du fichier : " + plainText.data);
	});*/

})();
</script>

</body>

</html>
